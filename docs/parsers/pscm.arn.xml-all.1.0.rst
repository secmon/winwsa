.. _pscm.arn.xml-all.1.0:

Autoruns-XML-All. 1.0 (pscm.arn.xml-all.1.0)
============================================

Общая информация
++++++++++++++++

Провайдер
+++++++++

Показатели собираются утилитой Autoruns (конкретно, ее консольной редакцией) командой:

  autorunsc.exe -a -v -x -accepteula * > out.xml
  
Собираются все возможные параметры (``-a``) как system-wide, так и по всем пользователям (``*``) 
с проверкой цифровых подписей (``-v``). Вывод программы - XML (``-x``).

Запуск допускается производить либо с повышенными привилегиями администратора, либо от имени системного пользователя (LOCAL SYSTEM).

XML-отчет
+++++++++

В XML-отчете все показатели описываются по одинаковой структуре (иногда некоторых полей нет), без явного разделения на типы (категории), что логически делается в GUI-варианте на основании поля location (таблица распределения по вкладкам встроена в программу и представлена в разделе Категории вендора).

Общая структура XML-файла:

.. code-block:: xml

  <?xml version="1.0" encoding="utf-16"?>
  <autoruns>
   <item>{поля показателя}</item>
   <item>{поля показателя}</item>
   ...
  </autoruns>
  
Описание каждого из полей показателей (могут как отсутствовать, так и быть пустыми):

.. glossary::

    ``location``
      Источник "автозагрузки" показателя. Это ключ реестра, в котором располагается показатель (при этом, используются 
      сокращения: HKLM, HKCR, HKCU), путь к INI-файлу, Task Scheduler для заданий планировщика. 
      Например: HKLM\System\CurrentControlSet\Control\Session Manager\BootExecute
      
    ``itemname``
      Имя показателя. В основном человекочитаемая интерпретация показателя. Например:
      autocheck autochk /k:C /k:D *, %systemroot%\system32\scext.dll, \avast! Emergency Update (имя задания)

    ``enabled``
      Состояние показателя. Autoruns позволяет отключать с возможностью восстановления те или иные ветки реестра, службы и т.п., просто перемещая их по определенному формату в другие ветки реестра или папки. Enabled или Disabled.
    
    ``profile``
      Профиль, к которому относится показатель. System-wide для показателей всего компьютера, DOMAIN\username для пользователя. При этом задания планировщика всегда относятся к System-wide.
    
    ``launchstring``
      Команда запуска (путь к DLL/драйверу). Для заданий указывается первое действие. Например: "%SystemRoot%\ehome\ehPrivJob.exe" /DoRecoveryTasks $(Arg0), msyuv.dll, autocheck autochk /k:C /k:D *.
    
    ``description``
      Описание службы, задания, расширения, гаджета, основного файла и т.п.
    
    ``company``
      Организация. Берется из описания основного файла (исполняемого файла службы, задания и т.п.)
    
    ``signer``
      Имя подписавшего основной файл с результатом проверки подписи. Например: (Verified) Microsoft Windows, (Not verified) Zabbix SIA. Если подписи нет, то берется company и префикс (Not verified). Если нет организации, поле пустое.
    
    ``version``
      Версия основного файла. Например, 6.1.7600.16385.
      
    ``imagepath``
      Путь к основному файлу. Может включать тильды.
      
    ``time``
      Время создания основного файла.
